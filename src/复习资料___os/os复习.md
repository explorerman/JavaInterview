# os复习

计划：

1. [哈工大张英涛老师的课程](https://www.bilibili.com/video/av12787154?from=search&seid=12328852833775475594)

## 操作系统引论

### 操作系统的定义：

操作系统是一组控制和关联计算机硬件和软件资源，合理地对各类作业进行调度，以及方便用户使用的程序集合

### 操作系统的目标：

1. **方便性**
2. **有效性**
3. 可扩展性
4. 开放性

### 操作系统作用

1. 用户与硬件系统的接口

   软件接口，给用户提供三种方式：命令方式，系统调用方式，图形、窗口方式

2. 计算机四类资源的管理者

   1. 处理机管理（硬件）
   2. 存储器管理（硬件）
   3. 设备管理（硬件）
   4. 文件管理（软件）

3. 用作扩充机器

   裸机：无任何软件的计算机系统

   扩充机器：覆盖了软件的机器又称为虚拟机

### 操作系统的发展过程

1. 无操作系统的计算机系统

2. 单道批处理系统（50年代）

   过程：一批作业以脱机方式输入到磁带上，**在监督程序**的控制下连续处理

   特征：

   1. 自动性：无人工干预
   2. 顺序性：按进入内存的先后执行
   3. 单道性：内存中只保持一道作业

3. 多道批处理系统（60年代）

   多道：内存中同时存放多个相互独立的程序

   多道技术是共享的基础。

   特征：

   1. 多道性：内存中有多道程序，可并发执行
   2. 无序性：完成时间与进入内存先后无关
   3. 调度性：作业从提交到完成经两次调度
      1. 作业调度：外存-> 内存（选多个）
      2. 进程调度：分配处理机（选1个）

   优缺点：

   1. 资源利用率高

   2. 系统吞吐量大：单位时间内完成的总工作量

      原因：资源忙，完成或运行不下去时才切换

   缺点:

   1. 平均周转时间长

      作业周转时间：从作业进入系统开始到完成并退出系统经历的时间，通常几小时，甚至几天。

   2.  无交互能力

      修改和调试极不方便。

4. 分时系统（60年代）

   定义：一台主机上连接了多个终端，同时允许多个用户通过自己的终端，以交互方式使用计算机，共享主机中的资源。

   产生动力:

   1. 人-机交互（边运行边调试）
   2. 共享主机（设备昂贵）
   3. 便于用户上机（在终端上输入，控制）

   分时系统特征：

   1. 多路性：即同时性，宏观上同时微观上轮流
   2. 独立性：**每个用户感觉独占主机**
   3. 及时性：较短时间响应（2-3秒）
   4. 交互性

5. 实时系统（60系统）

   实时：及时响应外部事件请求

   应用需求:

   1. 实时控制：工业生产、武器控制飞机的自动驾驶

   2. 实时信息处理：

      订票系统

### 操作系统基本特性

1. **并发性（最重要特征）**

   并行性：多个事件在同一时刻发生

   并发性：多个事件在同一时间间隔内发生

   单处理机系统：宏观并发微观串行

   多处理机系统：可能有并行

2. 共享性

   两种资源共享方式：

   1. 互斥共享方式：对临界资源的访问：打印机等硬件，栈、变量、表格等软件
   2. 同时访问方法：多个进程同时访问的资源：如：磁盘、重入码写的文件

   **操作系统的两个最基本特征：并发和共享**

3. 虚拟性

   虚拟：通过某种技术把一个物理实体变为若干个逻辑上的对应物。

   如：虚拟处理器、虚拟内存

4. 异步性

   异步性：进程以不可预知的速度向前推进。

### 操作系统的五大功能

### 操作系统的结构设计

操作系统的发展阶段:

传统OS结构

1. 无结构os
2. 模块化os结构
3. 分层式os结构

微内核os结构

## 进程管理

### 进程的基本概念

程序在并发环境中的执行过程

资源分配和独立运行的基本单位

**程序顺序执行的特征:**

1. 顺序性
   处理机的操作严格按照程序所规定的顺序执行，即每一个操作必须在下一操作之前结束。
2. 封闭性
   程序在封闭环境下执行，结果不受外界因素影响。
3. 可再现性
   只要环境和初始条件相同，程序重复执行时总得到相同结果。

**程序并发执行的特征**：

1. 间断性
   共享、合作、制约导致：执行-暂停-执行
2. 失去封闭性
   资源状态由多程序改变
3. 不可再现性
   相同环境和初始条件，重复执行结果不同。

**进程的特征**：

1. 结构特征
   PCB进程控制块：动态特征的集中反映
   程序段：描述要完成的功能
   数据段：操作对象及工作区
2. 动态性
   进程最基本的特征是动态性
   进程的生命周期：由创建而产生，由调度而执行，由撤销而消亡的过程。
3. 并发性
   多个进程同在内存中，且能在一段时间内同时运行。
4. 独立性
   进程是一个能独立运行、独立分配资源、独立接受调度的基本单位。
5. 异步性
   进程按各自独立的、不可预知的速度向前推进。

j

### 进程与程序的区别

1. 进程是一个动态概念，程序是一个静态概念
2. 进程具有并行特征，程序没有
3. 进程是竞争资源的基本单位
4. 一个程序对应多个进程，一个进程为多个程序服务。

### 进程控制

进程的三种基本状态：

1. 就绪状态
   进程已经分配了除处理机以外的所有必要资源，只要再获得处理机就能够执行的状态。
   这样的进程可能有多个，通常排成一个队列，称为就绪队列。
2. 执行状态
   已经获得CPU，正在运行。
   在单处理机系统只有一个进程出于执行状态，多处理机系统则有多个处于执行状态。
3. 阻塞状态
   正在执行的进程由于发送某事件而暂时无法继续执行时，放弃处理机而进入的状态，又称为等待状态。
   引起阻塞的事件：请求I/O，申请缓存。

进程的基本状态转化：

只有就绪和执行可以相互转化。
挂起状态：引入原因

1. 终端用户请求
2. 父进程请求
3. 负荷调节需要
4. 操作系统的需要

**PCB**：

1. pcb是os中最重要的记录型结构
2. os用PCB对并发进程进行管理和控制
3. PCB是进程存在的唯一标志
4. PCB常驻内存
5. OS专门开辟PCB区将所有的PCB组织成若干个链表或队列。
   pcb中的信息：
   1. 进程标识符
      内部标识符，进程唯一的数字编号，给OS使用
      外部标识符，由字母、数字组成，给用户使用
   2. 处理机状态
      通用寄存器，8-32个，暂存信息用
      指令计数器，要访问的下一条指令地址
      程序状态字PSW，条件码、执行方式，中断屏蔽标志
      用户栈指针，用户进程拥有的系统栈，存放过程和系统调用参数及调用地址。
   3. 进程调度信息
      进程状态
      进程优先级
      与调度算法有关信息
      事件 如：阻塞原因
   4. 进程控制信息
      程序和数据地址
      进程同步和通信机制
      资源清单：除CPU之外的所需资源与已经分配资源清单
      链接指针：本进程PCB所在队列的下一个地址。

信号量


### 进程同步

### 进程通信

进程通信的定义：进程之间交换信息

进程通信的分类：

1. 低级通信：进程的互斥和同步

2. 高级通信：用户可直接利用OS提供的一组通信命令，高效的传送大量数据的一种通信方式，对用户透明

   高级通信分类：

   1. 共享存储器系统
      共享数据结构的通信方式，**是低级通信方式**，如：缓冲池进行通信
      共享存储区通信方式：在存储器中划出一块共享存储区，进程可通过对共享存储区进行读或者写来实现通信，属于高级通信方式。
   2. 消息传递系统
      信息交换的单位是消息或者报文（计算机网络中将消息称为报文）
      直接通信
      间接通信
   3. 管道通信
      管道通信方式建立在文件系统的基础上，利用共享文件来连接两个相互通信的进程，此文件称为管道
      管道是指用于连接一个读进程和一个写进程，以实现他们之间通信的共享文件。
      **管道通信必须的协调能力**：互斥，同步，判断对方是否存在，只有确定了对方存在时方能进行通信。

   

### 线程

进程与线程的关系

引入线程的目的？
线程属性。

进程与程序的关系

## 处理机调度与死锁

一个批处理型作业，从进入系统并驻留在外存的后备队列上开始，直至作业运行完毕，可能要经历三级调度

1. 高级调度
   又称为：作业调度，作用：把外存上处于后备队列中的作业调入内存，并为他们创建进程、分配资源、排在就绪队列上，准备执行。
   **分时系统，实时系统，通常不需要作业调度（批处理）**
2. 中级调度
   又称：中程调度
   目的：提高内存利用率和系统吞吐率
   作用：使暂时不能运行的进程从**内存调至外存，进入就绪驻外存状态或挂起状态**。把外存上又具备运行条件的就绪进程，重新调入内存，并修改为就绪状态，挂在就绪队列上。
   又称：对换
3. 低级调度
   也称为：进程调度，短程调度。
   作用：决定就绪队列中的哪个进程应获得处理机，然后由分派程序执行把处理机分配给该进程的具体操作。
   **在OS中必须配置。**

g

非抢占式：自己放弃（I/O或者碰到原语P等）才会暂停执行
抢占原则：优先权原则、短作业优先原则、时间片原则（防止全是短作业在占用CPU）。
选择调度方式和调度算法的准则：

1. 面向用户的准则
   周转时间短、响应时间快、截止时间的保证、优先权准则
2. 面向系统的准则
   系统吞吐量、处理机利用率好、资源的平衡利用

**调度算法**：根据系统的资源分配策略所规定的资源分配算法，不同的系统和系统目标，通常采用不同的调度算法

1. 先来先服务调度算法（FCFS：first come first server）
   有利于长作业进程，不利于短作业进程。
   有利于CPU繁忙型作业，不利于I/O繁忙型作业。
2. 短作业（进程）优先法
   短作业优先（SJF）法
   短进程优先（SPF）调度算法。
   这两种做法对长作业不利，完全未考虑作业的紧迫程度，作业（进程）的长短根据用户所提供的估计执行时间而定的不一定能真正做到短作业优先调度。
3. 高优先权优先调度算法
   非抢占式优先权算法
   抢占式优先权调度算法
   优先权类型:静态优先权、动态优先权



## 存储器管理

## 设备管理

## 文件管理

先来先处理和短进程优先对比：是在第16讲

二者虽然开始和结束时间一样，举银行的例子，短进程可以理解为只是看一下账号钱，所以整体效率更高，看周转时间和带权周转时间



分页与分段的区别：页对程序员透明，是固定大小的，515-8k

段是程序员可控制的，最典型的就是方法，每个方法开辟的段空间不同。

 分页主要用于实现虚拟内存，从而获得更大的地址空间；分段主要是为了使程序和数据可以被划分为逻辑上独立的地址空间并且有助于共享和保护。 